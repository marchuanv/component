function Factory(){const o={};Object.defineProperty(this,"createContainer",{configurable:!1,writable:!1,value:({scopeId:e,type:s,variableName:n,singleton:t})=>{t=t?"global":e;if(!t)throw new Error("Factory: no scopeId provided.");o[t]||(o[t]=[]);const a=o[t],r={references:{},Id:utils.generateGUID(),type:s,name:n,scopeId:t,config:e=>{var t=e.references||e;for(const s of Object.keys(t))r.references[s]=t[s]},ensureInstance:()=>{if(r.references[n])return r.references[n];const e={scopeId:r.scopeId};for(const t of Object.keys(r.references))e[t]=r.references[t];r.references[n]=new s(e)}};return a.push(r),r}}),Object.defineProperty(this,"getContainer",{configurable:!1,writable:!1,value:({scopeId:e,type:t,variableName:s,singleton:n})=>{n=n?"global":e;if(n)return o[n]?o[n].find(e=>e.name===s&&e.type.name===t.name):null;throw new Error("Factory: no scopeId provided.")}})}function ClientMessageBus({httpClientRequestMessageBus:t,httpClientResponseMessageBus:e,webSocketClientRequestMessagebus:s,webSocketClientResponseMessageBus:n,messageConverter:a}){t&&e?(Object.defineProperty(this,"publish",{configurable:!1,writable:!1,value:async({message:e})=>{await t.publish(a.convertMessageToHttpRequestMessage({message:e}))}}),Object.defineProperty(this,"subscribe",{configurable:!1,writable:!1,value:({callback:t})=>{e.subscribe({callback:async({httpResponseMessage:e})=>{await t(a.convertHttpResponseMessageToMessage({httpResponseMessage:e}))}})}})):s&&n&&(Object.defineProperty(this,"publish",{configurable:!1,writable:!1,value:async({message:e})=>{await s.publish(a.convertMessageToWebSocketRequestMessage({message:e}))}}),Object.defineProperty(this,"subscribe",{configurable:!1,writable:!1,value:({callback:t})=>{n.subscribe({callback:async({webSocketResponseMessage:e})=>{await t(a.convertWebSocketResponseMessageToMessage({webSocketResponseMessage:e}))}})}}))}function Component({scopeId:n,clientMessageBus:a,serverMessageBus:r,userSessions:o,packageJson:e}){const{senderHost:i,senderPort:c,recipientHost:g,recipientPort:u,userId:p,timeout:d,isServerComponent:l}=e;Object.defineProperty(this,"initialise",{configurable:!1,writable:!1,value:async({secret:e})=>{const t=o.ensureSession({userId:p})["userSecurity"],s=(t.register({secret:e}),t.authenticate({secret:e}))["token"];l?(createHttpServerMessageBus({scopeId:n,timeout:d,senderHost:i,senderPort:c}),createHttpServerMessageBusManager({scopeId:n}),Object.defineProperty(this,"receive",{configurable:!1,writable:!1,value:async({callback:e})=>{await r.subscribe({callback:e})}}),Object.defineProperty(this,"send",{configurable:!1,writable:!1,value:async e=>{await r.publish(createMessage({scopeId:utils.generateGUID(),messageStatusCode:0,Id:null,data:e,recipientHost:g,recipientPort:u,metadata:{},token:s,senderHost:i,senderPort:c}))}})):(createHttpClientMessageBus({scopeId:n,timeout:d}),createHttpClientMessageBusManager({scopeId:n}),Object.defineProperty(this,"receive",{configurable:!1,writable:!1,value:async({callback:e})=>{await a.subscribe({callback:e})}}),Object.defineProperty(this,"send",{configurable:!1,writable:!1,value:async e=>{await a.publish(createMessage({scopeId:utils.generateGUID(),messageStatusCode:2,Id:null,data:e,recipientHost:g,recipientPort:u,metadata:{},token:s,senderHost:i,senderPort:c}))}}))}})}function ContentType({name:t}){var e=Object.values(types).findIndex(e=>e===t),e=0<Object.keys(types).findIndex(e=>e===t)?t:0<e?Object.keys(types)[e]:"unknown";Object.defineProperty(this,"name",{configurable:!1,writable:!1,value:e}),Object.defineProperty(this,"description",{configurable:!1,writable:!1,value:types[e]})}function Logger(){let o={},i=!1;Object.defineProperty(this,"log",{configurable:!1,writable:!1,value:({date:n,context:a,text:r})=>{return new Promise(t=>{const s=setInterval(()=>{if(!i){i=!0,o[a]||(o[a]=[]),o[a].push({date:n,text:r}),t(),o[a]=o[a].sort((e,t)=>new Date(e.date)-new Date(t.date));let e=o[a].shift();for(;e;){const{date:n,text:r}=e;console.log(n.toISOString()+`: ${a}, `+r),e=o[a].shift()}clearInterval(s),i=!1}},1e3)})}})}function Message({scopeId:s,Id:e,messageContent:t,messageContentMetadata:n,messageMetadata:a,messageStatus:r}){const o=e||utils.generateGUID();Object.defineProperty(this,"getId",{configurable:!1,writable:!1,value:()=>o}),Object.defineProperty(this,"getSenderAddress",{configurable:!1,writable:!1,value:()=>{var{senderhost:e,senderport:t}=a;return createSenderAddress({scopeId:s,senderHost:e,senderPort:t})}}),Object.defineProperty(this,"getRecipientAddress",{configurable:!1,writable:!1,value:()=>{var{recipienthost:e,recipientport:t}=a;return createRecipientAddress({scopeId:s,recipientHost:e,recipientPort:t})}}),Object.defineProperty(this,"getEncryptedContent",{configurable:!1,writable:!1,value:()=>t.encryptedData}),Object.defineProperty(this,"getDecryptedContent",{configurable:!1,writable:!1,value:()=>t.decryptedData}),Object.defineProperty(this,"getMessageMetadata",{configurable:!1,writable:!1,value:()=>a}),Object.defineProperty(this,"getContentMetadata",{configurable:!1,writable:!1,value:()=>n}),Object.defineProperty(this,"getMessageStatus",{configurable:!1,writable:!1,value:()=>r.root()})}function MessageContent({data:t,userSessions:s,messageMetadata:e,messageContentMetadata:n}){var e=e["token"],a=utils.getJSONObject(utils.base64ToString(e))["userId"];const r=s.ensureSession({userId:a})["userSecurity"];let o=null,i=null;if(r.isAuthorised({token:e})){var{contentType:s,isEncrypted:e}=n;if(e&&"base64Text"===s.name)o=r.decryptJSONToObject({encryptedJsonStr:t.replace("Encrypted:","")}),i=t;else{let e=null;"string"==typeof t&&"txt"===s.name&&(e={text:t}),i=r.encryptObjectToJSON({object:e}),o=r.decryptJSONToObject({encryptedJsonStr:i}),i="Encrypted:"+i,n.setContentType({name:"txt"}),n.setContentLength({length:Buffer.byteLength(i)})}}else o=`unable to decrypt message content, '${a}' user is not authorised.`,i=`unable to encrypt message content, '${a}' user is not authorised.`;Object.defineProperty(this,"encryptedData",{configurable:!1,writable:!1,value:i}),Object.defineProperty(this,"decryptedData",{configurable:!1,writable:!1,value:o})}function MessageContentMetadata({scopeId:t,data:e}){let s=!1,n=null,a=utils.getJSONObject(e)||e,r=("object"==typeof a?(n="json",a=utils.getJSONString(a)):"string"==typeof a&&(n="txt",s=e.startsWith("Encrypted:"),utils.isBase64String(e.replace("Encrypted:",""))&&(n="base64Text")),createContentType({scopeId:t,name:n}))["contentType"],o=Buffer.byteLength(a);Object.defineProperty(this,"contentType",{configurable:!1,get:()=>r}),Object.defineProperty(this,"contentLength",{configurable:!1,get:()=>o}),Object.defineProperty(this,"isEncrypted",{configurable:!1,writable:!1,value:s}),Object.defineProperty(this,"setContentLength",{configurable:!1,writable:!1,value:({length:e})=>o=e}),Object.defineProperty(this,"setContentType",{configurable:!1,writable:!1,value:({name:e})=>r=createContentType({scopeId:t,name:e})})}function MessageConverter(){Object.defineProperty(this,"convertMessageToHttpRequestMessage",{configurable:!1,writable:!1,value:({message:e})=>{var t=e.getId(),s=e.getEncryptedContent(),{senderHost:n,senderPort:a}=e.getSenderAddress(),{recipientHost:r,recipientPort:o}=e.getRecipientAddress(),i=e.getMessageMetadata(),c=i["token"],e=e.getMessageStatus()["code"];return createHttpRequestMessage({scopeId:utils.generateGUID(),messageStatusCode:e,Id:t,data:s,recipientHost:r,recipientPort:o,metadata:i,token:c,senderHost:n,senderPort:a})}}),Object.defineProperty(this,"convertMessageToHttpResponseMessage",{configurable:!1,writable:!1,value:({message:e})=>{var t=e.getMessageStatus()["code"],s=e.getId(),n=e.getEncryptedContent(),{recipientHost:a,recipientPort:r}=e.getRecipientAddress(),o=e.getMessageMetadata(),i=o["token"],{senderHost:e,senderPort:c}=e.getSenderAddress();return createHttpResponseMessage({scopeId:utils.generateGUID(),messageStatusCode:t,Id:s,data:n,recipientHost:a,recipientPort:r,metadata:o,token:i,senderHost:e,senderPort:c})}}),Object.defineProperty(this,"convertHttpRequestMessageToMessage",{configurable:!1,writable:!1,value:({httpRequestMessage:e})=>{var t=e.getMessageStatus()["code"],s=e.getId(),n=e.getEncryptedContent(),{recipientHost:a,recipientPort:r}=e.getRecipientAddress(),o=e.getMessageMetadata(),i=o["token"],{senderHost:e,senderPort:c}=e.getSenderAddress();return createMessage({scopeId:utils.generateGUID(),messageStatusCode:t,Id:s,data:n,recipientHost:a,recipientPort:r,metadata:o,token:i,senderHost:e,senderPort:c})}}),Object.defineProperty(this,"convertHttpResponseMessageToMessage",{configurable:!1,writable:!1,value:({httpResponseMessage:e})=>{var t=e.getMessageStatus()["code"],s=e.getId(),n=e.getEncryptedContent(),{recipientHost:a,recipientPort:r}=e.getRecipientAddress(),o=e.getMessageMetadata(),i=o["token"],{senderHost:e,senderPort:c}=e.getSenderAddress();return createMessage({scopeId:utils.generateGUID(),messageStatusCode:t,Id:s,data:n,recipientHost:a,recipientPort:r,metadata:o,token:i,senderHost:e,senderPort:c})}})}function MessageMetadata({metadata:e,token:t,senderAddress:s,recipientAddress:n}){Object.defineProperty(this,"create",{configurable:!1,writable:!1,value:({name:t,value:e})=>{getProperties({object:this}).find(e=>e.propertyName===t)||Object.defineProperty(this,t,{configurable:!1,get:()=>isNaN(e)?e:Number(e)})}}),this.create({name:"token",value:t});for(const a of getProperties({object:e}))this.create({name:a.propertyName,value:a.propertyValue});for(const r of getProperties({object:s}))this.create({name:r.propertyName,value:r.propertyValue});for(const o of getProperties({object:n}))this.create({name:o.propertyName,value:o.propertyValue})}function MessageQueue({logger:a}){const r={},o=async({binding:t})=>{if(0!==t.callbacks.length&&0!==t.messages.length)if(t.locked)log({logger:a,binding:t,text:"waiting for queue lock"}),setTimeout(()=>o({binding:t}),1e3);else{t.locked=!0;const s=t.callbacks.sort((e,t)=>e.priority-t.priority),n=s.shift();log({logger:a,binding:t,text:`pulling message (1 of ${t.messages.length})`});var e=t.messages.shift()["message"];try{await n.resolve({message:e})}catch(e){log({logger:a,binding:t,text:`callback error: ${e.message}.`})}t.locked=!1,o({binding:t})}},i=async({binding:t})=>{if(0!==t.peekCallbacks.length)if(t.locked)log({logger:a,binding:t,text:"waiting for queue lock"}),setTimeout(()=>i({binding:t}),1e3);else{t.locked=!0,log({logger:a,binding:t,text:`peeking at first message (1 of ${t.messages.length})`});var e=(t.messages[t.messages.length-1]||{message:null})["message"];try{const s=t.peekCallbacks.shift();await s.resolve({message:e})}catch(e){log({logger:a,binding:t,text:`callback error: ${e.message}.`})}t.locked=!1,i({binding:t})}};Object.defineProperty(this,"queueMessage",{configurable:!1,writable:!1,value:async({message:e,queueName:t})=>{var s=utils.generateGUID();const n=r[t];log({logger:a,binding:n,text:`pushing message (1 of ${n.messages.length})`}),n.messages.push({Id:s,queueName:t,message:e}),i({binding:n}),o({binding:n})}}),Object.defineProperty(this,"dequeueMessage",{configurable:!1,writable:!1,value:({queueName:a})=>new Promise(e=>{var t=utils.generateGUID();const s=r[a];var n=s.callbacks.length-1+1;s.callbacks.push({Id:t,queueName:a,resolve:e,priority:n}),o({binding:s})})}),Object.defineProperty(this,"peekMessage",{configurable:!1,writable:!1,value:({queueName:n})=>new Promise(e=>{var t=utils.generateGUID();const s=r[n];s.peekCallbacks.push({Id:t,queueName:n,resolve:e}),i({binding:s})})}),Object.defineProperty(this,"bind",{configurable:!1,writable:!1,value:({scopeId:e,bindingObj:t})=>{const s=e+"_"+t.constructor.name;Object.defineProperty(t,"name",{configurable:!1,writable:!1,value:s}),Object.defineProperty(t,"messages",{configurable:!1,writable:!1,value:[]}),Object.defineProperty(t,"callbacks",{configurable:!1,writable:!1,value:[]}),Object.defineProperty(t,"peekCallbacks",{configurable:!1,writable:!1,value:[]}),Object.defineProperty(t,"queueMessage",{configurable:!1,writable:!0,value:async({message:e})=>{await this.queueMessage({message:e,queueName:s})}}),Object.defineProperty(t,"dequeueMessage",{configurable:!1,writable:!0,value:async()=>this.dequeueMessage({queueName:s})}),Object.defineProperty(t,"peekMessage",{configurable:!1,writable:!0,value:async()=>this.peekMessage({queueName:s})}),Object.defineProperty(t,"unbind",{configurable:!1,writable:!1,value:()=>{Object.defineProperty(t,"queueMessage",{configurable:!1,writable:!0,value:()=>{log({logger:a,binding:t,text:"unbinded and not queueing messages anymore."})}}),Object.defineProperty(t,"dequeueMessage",{configurable:!1,writable:!0,value:()=>new Promise(()=>{log({logger:a,binding:t,text:"unbinded and not dequeueing messages anymore."})})}),Object.defineProperty(t,"peekMessage",{configurable:!1,writable:!0,value:()=>new Promise(()=>{log({logger:a,binding:t,text:"unbinded and not peeking at messages anymore."})})}),this.unbind({queueName:s})}}),r[s]=t}}),Object.defineProperty(this,"unbind",{configurable:!1,writable:!1,value:({queueName:e})=>{delete r[e]}})}function MessageStatus({messageStatusCode:t}){var{code:e,description:s,parent:n}=allMessageStatus.find(e=>e.code===t||e.code===t.toString());this.code=e,this.description=s,this.parent=n?new MessageStatus({messageStatusCode:n.code}):null,Object.defineProperty(this,"match",{configurable:!1,writable:!1,value:({wildcard:e})=>{for(const t of allMessageStatus.filter(e=>e.parent&&e.parent.code===this.code))if(-1<t.description.toLowerCase().indexOf(e))return t;return null}}),Object.defineProperty(this,"root",{configurable:!1,writable:!1,value:()=>{if(null===this.parent)return this;{let e=this.parent,t=null;for(;e;)e=(t=e).parent;return t}}})}function MessageStore(){Object.defineProperty(this,"save",{configurable:!1,writable:!1,value:async({})=>{}}),Object.defineProperty(this,"get",{configurable:!1,writable:!1,value:async({})=>{}})}function RecipientAddress({recipientHost:e,recipientPort:t}){Object.defineProperty(this,"recipientHost",{configurable:!1,writable:!1,value:e}),Object.defineProperty(this,"recipientPort",{configurable:!1,writable:!1,value:t})}function SenderAddress({senderHost:e,senderPort:t}){Object.defineProperty(this,"senderHost",{configurable:!1,writable:!1,value:e}),Object.defineProperty(this,"senderPort",{configurable:!1,writable:!1,value:t})}function ServerMessageBus({httpServerResponseMessageBus:t,httpServerRequestMessageBus:e,webSocketServerRequestMessageBus:s,webSocketServerResponseMessageBus:n,messageConverter:a}){e&&t?(Object.defineProperty(this,"publish",{configurable:!1,writable:!1,value:async({message:e})=>{await t.publish(a.convertMessageToHttpResponseMessage({message:e}))}}),Object.defineProperty(this,"subscribe",{configurable:!1,writable:!1,value:({callback:t})=>{e.subscribe({callback:async({httpRequestMessage:e})=>{await t(a.convertHttpRequestMessageToMessage({httpRequestMessage:e}))}})}})):s&&n&&(Object.defineProperty(this,"publish",{configurable:!1,writable:!1,value:async({message:e})=>{await n.publish(a.convertMessageToWebSocketResponseMessage({message:e}))}}),Object.defineProperty(this,"subscribe",{configurable:!1,writable:!1,value:({callback:t})=>{s.subscribe({callback:async({webSocketRequestMessage:e})=>{await t(a.convertWebSocketRequestMessageToMessage({webSocketRequestMessage:e}))}})}}))}function UserSecurity({userId:n}){let a=null,r,o,i=userIdentities[n],c=null;Object.defineProperty(this,"isRegistered",{configurable:!1,writable:!1,value:()=>void 0!==i}),Object.defineProperty(this,"authenticate",{configurable:!1,writable:!1,value:({secret:e,remoteBase64RSAPublickey:t})=>{c=null;var s,e=utils.hashPassphrase(e,i.hashedPassphraseSalt)["hashedPassphrase"];return e===i.hashedPassphrase&&({privateKey:e,publicKey:s}=utils.generatePublicPrivateKeys(e),r=utils.stringToBase64(e),o=utils.stringToBase64(s),a=t||o,{token:c=utils.stringToBase64(utils.getJSONString({userId:n,base64RSAPublicKey:o}))})}}),Object.defineProperty(this,"isAuthorised",{configurable:!1,writable:!1,value:({token:e})=>utils.isBase64String(r)&&utils.isBase64String(o)&&c===e}),Object.defineProperty(this,"register",{configurable:!1,writable:!1,value:({secret:e})=>{var{hashedPassphrase:e,hashedPassphraseSalt:t}=utils.hashPassphrase(e);i={hashedPassphrase:e,hashedPassphraseSalt:t},userIdentities[n]=i,fs.writeFileSync(userIdentitiesStorePath,JSON.stringify(userIdentities),"utf8")}}),Object.defineProperty(this,"unregister",{configurable:!1,writable:!1,value:()=>{delete userIdentities[n],fs.writeFileSync(userIdentitiesStorePath,JSON.stringify(userIdentities),"utf8")}}),Object.defineProperty(this,"getHashedPassphrase",{configurable:!1,writable:!1,value:()=>i.hashedPassphrase}),Object.defineProperty(this,"getUserId",{configurable:!1,writable:!1,value:()=>n}),Object.defineProperty(this,"getBase64PublicKey",{configurable:!1,writable:!1,value:()=>({base64RSAPublicKey:o})}),Object.defineProperty(this,"getPublicKey",{configurable:!1,writable:!1,value:()=>({publicKey:utils.base64ToString(o)})}),Object.defineProperty(this,"getToken",{configurable:!1,writable:!1,value:()=>({token:c})}),Object.defineProperty(this,"encryptObjectToJSON",{configurable:!1,writable:!1,value:({object:e})=>{e=utils.getJSONString(e)||"{}";return utils.encryptToBase64Str(e,utils.base64ToString(a))}}),Object.defineProperty(this,"decryptJSONToObject",{configurable:!1,writable:!1,value:({encryptedJsonStr:e})=>{var t=this.getHashedPassphrase(),s=utils.base64ToString(r);return utils.getJSONObject(utils.decryptFromBase64Str(e,s,t))}})}function UserSessions({scopeId:s}){const n={};Object.defineProperty(this,"ensureSession",{configurable:!1,writable:!1,value:({userId:e})=>{var t;return n[e]||(t=createUserSecurity({scopeId:s,userId:e})["userSecurity"],n[e]=t),{userSecurity:n[e]}}})}function HttpClientMessageBus({scopeId:t,httpClientRequestMessageQueueBinding:s,httpClientResponseMessageQueueBinding:c,httpClientStartMessageQueueBinding:e,httpClientStartedMessageQueueBinding:n,httpClientStopMessageQueueBinding:a,timeout:g}){const r=async({callback:e})=>{var t=(await s.dequeueMessage())["message"];await e({message:t}),await r({callback:e})};a.dequeueMessage().then(({message:e})=>{e.scopeId!==t?a.queueMessage({message:e}):(s.unbind(),c.unbind())}),e.dequeueMessage().then(async()=>{n.queueMessage({message:{scopeId:t}}),r({callback:({message:e})=>{const t=e;var{recipientHost:e,recipientPort:s}=t.getRecipientAddress(),n=t.getPath(),a=t.getHeaders(),r=t.getMethod(),o=t.getEncryptedContent();const i=http.request({host:e,port:s,path:n,headers:a,method:r});i.setTimeout(g),i.on("response",async e=>{e.setEncoding("utf8"),e.on("error",e=>console.error(e)),e.body="";for await(const t of e)e.body+=t;await c.queueMessage({message:e})}),i.on("error",e=>console.error(e)),i.end(o)}})})}function HttpClientMessageBusManager({scopeId:t,httpClientStartMessageQueueBinding:s,httpClientStartedMessageQueueBinding:e,httpClientStopMessageQueueBinding:n}){e.peekMessage().then(({message:e})=>{e&&n.queueMessage({message:{scopeId:e.scopeId}}),s.queueMessage({message:{scopeId:t}})})}function HttpClientRequestMessageBus({httpClientRequestMessageQueueBinding:t}){Object.defineProperty(this,"publish",{configurable:!1,writable:!1,value:({httpRequestMessage:e})=>{t.queueMessage({message:e})}})}function HttpClientRequestMessageQueueBinding({scopeId:e,messageQueue:t}){t.bind({bindingObj:this,scopeId:e})}function HttpClientResponseMessageBus({httpClientResponseMessageQueueBinding:e}){const g=require("../factory/httpresponsemessage.factory")["createHttpResponseMessage"];Object.defineProperty(this,"subscribe",{configurable:!1,writable:!1,value:({callback:c})=>{e.dequeueMessage().then(async({message:e})=>{var{body:e,statusCode:t,headers:s}=e,{recipienthost:n,recipientport:a,senderhost:r,senderport:o,token:i}=s;await c(g({scopeId:utils.generateGUID(),messageStatusCode:t,Id:null,data:e,recipientHost:n,recipientPort:a,metadata:s,token:i,senderHost:r,senderPort:o})),this.subscribe({callback:c})})}})}function HttpClientResponseMessageQueueBinding({scopeId:e,messageQueue:t}){t.bind({bindingObj:this,scopeId:e})}function HttpClientStartedMessageQueueBinding({scopeId:e,messageQueue:t}){t.bind({bindingObj:this,scopeId:e})}function HttpClientStartMessageQueueBinding({scopeId:e,messageQueue:t}){t.bind({bindingObj:this,scopeId:e})}function HttpClientStopMessageQueueBinding({scopeId:e,messageQueue:t}){t.bind({bindingObj:this,scopeId:e})}function HttpClientStoppedMessageQueueBinding({scopeId:e,messageQueue:t}){t.bind({bindingObj:this,scopeId:e})}function HttpRequestMessage({message:t}){var{senderHost:e,senderPort:s}=t.getSenderAddress(),{recipientHost:n,recipientPort:a}=t.getRecipientAddress();const{path:r,secret:o,token:i}=t.getMessageMetadata();var{contentType:c,contentLength:g}=t.getContentMetadata();const u={"Content-Type":c.description,"Content-Length":g,secret:o,token:i,senderhost:e,senderport:s,recipienthost:n,recipientport:a};Object.defineProperty(this,"getId",{configurable:!1,writable:!1,value:t.getId}),Object.defineProperty(this,"getEncryptedContent",{configurable:!1,writable:!1,value:t.getEncryptedContent}),Object.defineProperty(this,"getDecryptedContent",{configurable:!1,writable:!1,value:t.getDecryptedContent}),Object.defineProperty(this,"getSenderAddress",{configurable:!1,writable:!1,value:t.getSenderAddress}),Object.defineProperty(this,"getRecipientAddress",{configurable:!1,writable:!1,value:t.getRecipientAddress}),Object.defineProperty(this,"getContentMetadata",{configurable:!1,writable:!1,value:t.getContentMetadata}),Object.defineProperty(this,"getMessageMetadata",{configurable:!1,writable:!1,value:t.getMessageMetadata}),Object.defineProperty(this,"getHeaders",{configurable:!1,writable:!1,value:()=>utils.getJSONObject(utils.getJSONString(u))}),Object.defineProperty(this,"getPath",{configurable:!1,writable:!1,value:()=>r}),Object.defineProperty(this,"getMethod",{configurable:!1,writable:!1,value:()=>"POST"}),Object.defineProperty(this,"getMessageStatus",{configurable:!1,writable:!1,value:()=>{const e=t.getMessageStatus();return e.match({wildcard:"http"})}})}function HttpResponseMessage({message:s}){var{senderHost:e,senderPort:t}=s.getSenderAddress(),{recipientHost:n,recipientPort:a}=s.getRecipientAddress(),r=s.getMessageMetadata()["token"],{contentType:o,contentLength:i}=s.getContentMetadata();const c={"Content-Type":o.description,"Content-Length":i,senderhost:e,senderport:t,recipienthost:n,recipientport:a,token:r};Object.defineProperty(this,"getId",{configurable:!1,writable:!1,value:s.getId}),Object.defineProperty(this,"getEncryptedContent",{configurable:!1,writable:!1,value:s.getEncryptedContent}),Object.defineProperty(this,"getDecryptedContent",{configurable:!1,writable:!1,value:s.getDecryptedContent}),Object.defineProperty(this,"getSenderAddress",{configurable:!1,writable:!1,value:s.getSenderAddress}),Object.defineProperty(this,"getRecipientAddress",{configurable:!1,writable:!1,value:s.getRecipientAddress}),Object.defineProperty(this,"getContentMetadata",{configurable:!1,writable:!1,value:s.getContentMetadata}),Object.defineProperty(this,"getMessageMetadata",{configurable:!1,writable:!1,value:s.getMessageMetadata}),Object.defineProperty(this,"getMessageStatus",{configurable:!1,writable:!1,value:s.getMessageStatus}),Object.defineProperty(this,"getHeaders",{configurable:!1,writable:!1,value:()=>utils.getJSONObject(utils.getJSONString(c))}),Object.defineProperty(this,"getStatusCode",{configurable:!1,writable:!1,value:()=>{const e=s.getMessageStatus();var t=e.match({wildcard:"http"})["code"];return t}}),Object.defineProperty(this,"getStatusMessage",{configurable:!1,writable:!1,value:()=>{const e=s.getMessageStatus();var t=e.match({wildcard:"http"})["description"];return t}})}function HttpServerMessageBus({scopeId:a,httpServerRequestMessageQueueBinding:r,httpServerResponseMessageQueueBinding:o,httpServerStartMessageQueueBinding:e,httpServerStartedMessageQueueBinding:i,httpServerStopMessageQueueBinding:c,httpServerStoppedMessageQueueBinding:g,senderAddress:u,logger:p,timeout:d}){e.dequeueMessage().then(()=>{var{senderHost:e,senderPort:t}=u;const s={host:e,port:t},n=http.createServer();n.on("error",t=>{s.host?dns.lookup(s.host,e=>{e?p.log({date:new Date,context:"HttpServer",text:e.message}):p.log({date:new Date,context:"HttpServer",text:t.message})}):p.log({date:new Date,context:"HttpServer",text:"host not specified"})}),n.on("request",async(e,t)=>{e.setTimeout(d),e.on("error",e=>console.error(e)),e.body="";for await(const n of e)e.body+=n;await r.queueMessage({message:e});const s=(await o.dequeueMessage())["message"];t.writeHead(s.getStatusCode(),s.getStatusMessage(),s.getHeaders()).end(s.getEncryptedContent())}),n.on("listening",()=>{p.log({date:new Date,context:"HttpServer",text:"listening on: "+utils.getJSONString(s)}),i.queueMessage({message:{scopeId:a}})}),n.on("close",()=>{p.log({date:new Date,context:"HttpServer",text:"server was stopped"}),r.unbind(),o.unbind(),g.queueMessage({message:{scopeId:a}})}),c.dequeueMessage().then(()=>{n.close()}),n.listen(s)})}function HttpServerMessageBusManager({scopeId:s,httpServerStartMessageQueueBinding:n,httpServerStartedMessageQueueBinding:e,httpServerStopMessageQueueBinding:a,httpServerStoppedMessageQueueBinding:r}){e.peekMessage().then(({message:e})=>{if(e){const t=e;a.queueMessage({message:{scopeId:t.scopeId}}),r.dequeueMessage().then(({message:e})=>{s!==e.scopeId&&t.scopeId===e.scopeId&&n.queueMessage({message:{scopeId:s}})})}else n.queueMessage({message:{scopeId:s}})})}function HttpServerRequestMessageBus({httpServerRequestMessageQueueBinding:e}){const u=require("../factory/httprequestmessage.factory")["createHttpRequestMessage"];Object.defineProperty(this,"subscribe",{configurable:!1,writable:!1,value:({callback:g})=>{e.dequeueMessage().then(async({message:e})=>{var{headers:e,body:t,path:s}=e;const n=e;let{recipienthost:a,recipientport:r,senderhost:o,senderport:i,token:c}=n;r=isNaN(r)?r:Number(r),i=isNaN(i)?i:Number(i),n.recipientport=r,n.senderport=i,n.path=s;await g(u({scopeId:utils.generateGUID(),messageStatusCode:2,Id:null,data:t,recipientHost:a,recipientPort:r,metadata:n,token:c,senderHost:o,senderPort:i})),this.subscribe({callback:g})})}})}function HttpServerRequestMessageQueueBinding({scopeId:e,messageQueue:t}){t.bind({bindingObj:this,scopeId:e})}function HttpServerResponseMessageBus({httpServerResponseMessageQueueBinding:t}){Object.defineProperty(this,"publish",{configurable:!1,writable:!1,value:async({httpResponseMessage:e})=>{await t.queueMessage({message:e})}})}function HttpServerResponseMessageQueueBinding({scopeId:e,messageQueue:t}){t.bind({bindingObj:this,scopeId:e})}function HttpServerStartedMessageQueueBinding({scopeId:e,messageQueue:t}){t.bind({bindingObj:this,scopeId:e})}function HttpServerStartMessageQueueBinding({scopeId:e,messageQueue:t}){t.bind({bindingObj:this,scopeId:e})}function HttpServerStopMessageQueueBinding({scopeId:e,messageQueue:t}){t.bind({bindingObj:this,scopeId:e})}function HttpServerStoppedMessageQueueBinding({scopeId:e,messageQueue:t}){t.bind({bindingObj:this,scopeId:e})}function WebSocketClientRequestMessageBus({websocketClientRequestMessageQueueBinding:t}){Object.defineProperty(this,"publish",{configurable:!1,writable:!1,value:({websocketRequestMessage:e})=>{t.queueMessage({message:e})}})}function WebSocketClientRequestMessageQueueBinding({scopeId:e,messageQueue:t}){t.bind({bindingObj:this,scopeId:e})}function WebSocketClientResponseMessageBus({websocketClientResponseMessageQueueBinding:e}){const g=require("../factory/websocketresponsemessage.factory")["createWebSocketResponseMessage"];Object.defineProperty(this,"subscribe",{configurable:!1,writable:!1,value:({callback:c})=>{e.dequeueMessage().then(async({message:e})=>{var{body:e,statusCode:t,headers:s}=e,{recipienthost:n,recipientport:a,senderhost:r,senderport:o,token:i}=s;await c(g({scopeId:utils.generateGUID(),messageStatusCode:t,Id:null,data:e,recipientHost:n,recipientPort:a,metadata:s,token:i,senderHost:r,senderPort:o})),this.subscribe({callback:c})})}})}function WebSocketClientResponseMessageQueueBinding({scopeId:e,messageQueue:t}){t.bind({bindingObj:this,scopeId:e})}function createClientMessageBus({scopeId:e}){let t=factory.getContainer({scopeId:e,type:ClientMessageBus,variableName:"clientMessageBus",singleton:!1});return t||((t=factory.createContainer({scopeId:e,type:ClientMessageBus,variableName:"clientMessageBus",singleton:!1})).config({}),t.config(createWebSocketClientResponseMessageBus({scopeId:e})),t.config(createWebSocketClientRequestMessageBus({scopeId:e})),t.config(createHttpClientResponseMessageBus({scopeId:e})),t.config(createHttpClientRequestMessageBus({scopeId:e})),t.config(createMessageConverter({scopeId:e}))),t.ensureInstance(),t.references}function createComponent({scopeId:e,packageJson:t,webSocketServerRequestMessageBus:s,webSocketServerResponseMessageBus:n}){let a=factory.getContainer({scopeId:e,type:Component,variableName:"component",singleton:!1});return a||((a=factory.createContainer({scopeId:e,type:Component,variableName:"component",singleton:!1})).config({packageJson:t,webSocketServerRequestMessageBus:s,webSocketServerResponseMessageBus:n}),a.config(createUserSessions({scopeId:e})),a.config(createServerMessageBus({scopeId:e,webSocketServerRequestMessageBus:s,webSocketServerResponseMessageBus:n})),a.config(createClientMessageBus({scopeId:e}))),a.ensureInstance(),a.references}function createContentType({scopeId:e,name:t}){let s=factory.getContainer({scopeId:e,type:ContentType,variableName:"contentType",singleton:!1});return s||(s=factory.createContainer({scopeId:e,type:ContentType,variableName:"contentType",singleton:!1})).config({name:t}),s.ensureInstance(),s.references}function createLogger({scopeId:e}){let t=factory.getContainer({scopeId:e,type:Logger,variableName:"logger",singleton:!0});return t||(t=factory.createContainer({scopeId:e,type:Logger,variableName:"logger",singleton:!0})).config({}),t.ensureInstance(),t.references}function createMessage({scopeId:e,messageStatusCode:t,Id:s,data:n,recipientHost:a,recipientPort:r,metadata:o,token:i,senderHost:c,senderPort:g}){let u=factory.getContainer({scopeId:e,type:Message,variableName:"message",singleton:!1});return u||((u=factory.createContainer({scopeId:e,type:Message,variableName:"message",singleton:!1})).config({messageStatusCode:t,Id:s,data:n,recipientHost:a,recipientPort:r,metadata:o,token:i,senderHost:c,senderPort:g}),u.config(createMessageMetadata({scopeId:e,recipientHost:a,recipientPort:r,metadata:o,token:i,senderHost:c,senderPort:g})),u.config(createMessageContentMetadata({scopeId:e,data:n})),u.config(createMessageContent({scopeId:e,data:n,recipientHost:a,recipientPort:r,metadata:o,token:i,senderHost:c,senderPort:g})),u.config(createMessageStatus({scopeId:e,messageStatusCode:t}))),u.ensureInstance(),u.references}function createMessageContent({scopeId:e,data:t,recipientHost:s,recipientPort:n,metadata:a,token:r,senderHost:o,senderPort:i}){let c=factory.getContainer({scopeId:e,type:MessageContent,variableName:"messageContent",singleton:!1});return c||((c=factory.createContainer({scopeId:e,type:MessageContent,variableName:"messageContent",singleton:!1})).config({data:t,recipientHost:s,recipientPort:n,metadata:a,token:r,senderHost:o,senderPort:i}),c.config(createMessageMetadata({scopeId:e,recipientHost:s,recipientPort:n,metadata:a,token:r,senderHost:o,senderPort:i})),c.config(createUserSessions({scopeId:e})),c.config(createMessageContentMetadata({scopeId:e,data:t}))),c.ensureInstance(),c.references}function createMessageContentMetadata({scopeId:e,data:t}){let s=factory.getContainer({scopeId:e,type:MessageContentMetadata,variableName:"messageContentMetadata",singleton:!1});return s||(s=factory.createContainer({scopeId:e,type:MessageContentMetadata,variableName:"messageContentMetadata",singleton:!1})).config({data:t}),s.ensureInstance(),s.references}function createMessageConverter({scopeId:e}){let t=factory.getContainer({scopeId:e,type:MessageConverter,variableName:"messageConverter",singleton:!1});return t||(t=factory.createContainer({scopeId:e,type:MessageConverter,variableName:"messageConverter",singleton:!1})).config({}),t.ensureInstance(),t.references}function createMessageMetadata({scopeId:e,recipientHost:t,recipientPort:s,metadata:n,token:a,senderHost:r,senderPort:o}){let i=factory.getContainer({scopeId:e,type:MessageMetadata,variableName:"messageMetadata",singleton:!1});return i||((i=factory.createContainer({scopeId:e,type:MessageMetadata,variableName:"messageMetadata",singleton:!1})).config({recipientHost:t,recipientPort:s,metadata:n,token:a,senderHost:r,senderPort:o}),i.config(createSenderAddress({scopeId:e,senderHost:r,senderPort:o})),i.config(createRecipientAddress({scopeId:e,recipientHost:t,recipientPort:s}))),i.ensureInstance(),i.references}function createMessageQueue({scopeId:e}){let t=factory.getContainer({scopeId:e,type:MessageQueue,variableName:"messageQueue",singleton:!0});return t||((t=factory.createContainer({scopeId:e,type:MessageQueue,variableName:"messageQueue",singleton:!0})).config({}),t.config(createLogger({scopeId:e}))),t.ensureInstance(),t.references}function createMessageStatus({scopeId:e,messageStatusCode:t}){let s=factory.getContainer({scopeId:e,type:MessageStatus,variableName:"messageStatus",singleton:!1});return s||(s=factory.createContainer({scopeId:e,type:MessageStatus,variableName:"messageStatus",singleton:!1})).config({messageStatusCode:t}),s.ensureInstance(),s.references}function createMessageStore({scopeId:e}){let t=factory.getContainer({scopeId:e,type:MessageStore,variableName:"messageStore",singleton:!1});return t||(t=factory.createContainer({scopeId:e,type:MessageStore,variableName:"messageStore",singleton:!1})).config({}),t.ensureInstance(),t.references}function createRecipientAddress({scopeId:e,recipientHost:t,recipientPort:s}){let n=factory.getContainer({scopeId:e,type:RecipientAddress,variableName:"recipientAddress",singleton:!1});return n||(n=factory.createContainer({scopeId:e,type:RecipientAddress,variableName:"recipientAddress",singleton:!1})).config({recipientHost:t,recipientPort:s}),n.ensureInstance(),n.references}function createSenderAddress({scopeId:e,senderHost:t,senderPort:s}){let n=factory.getContainer({scopeId:e,type:SenderAddress,variableName:"senderAddress",singleton:!1});return n||(n=factory.createContainer({scopeId:e,type:SenderAddress,variableName:"senderAddress",singleton:!1})).config({senderHost:t,senderPort:s}),n.ensureInstance(),n.references}function createServerMessageBus({scopeId:e,webSocketServerRequestMessageBus:t,webSocketServerResponseMessageBus:s}){let n=factory.getContainer({scopeId:e,type:ServerMessageBus,variableName:"serverMessageBus",singleton:!1});return n||((n=factory.createContainer({scopeId:e,type:ServerMessageBus,variableName:"serverMessageBus",singleton:!1})).config({webSocketServerRequestMessageBus:t,webSocketServerResponseMessageBus:s}),n.config(createHttpServerRequestMessageBus({scopeId:e})),n.config(createHttpServerResponseMessageBus({scopeId:e})),n.config(createMessageConverter({scopeId:e}))),n.ensureInstance(),n.references}function createUserSecurity({scopeId:e,userId:t}){let s=factory.getContainer({scopeId:e,type:UserSecurity,variableName:"userSecurity",singleton:!1});return s||(s=factory.createContainer({scopeId:e,type:UserSecurity,variableName:"userSecurity",singleton:!1})).config({userId:t}),s.ensureInstance(),s.references}function createUserSessions({scopeId:e}){let t=factory.getContainer({scopeId:e,type:UserSessions,variableName:"userSessions",singleton:!0});return t||(t=factory.createContainer({scopeId:e,type:UserSessions,variableName:"userSessions",singleton:!0})).config({}),t.ensureInstance(),t.references}function createHttpClientMessageBus({scopeId:e,timeout:t}){let s=factory.getContainer({scopeId:e,type:HttpClientMessageBus,variableName:"httpClientMessageBus",singleton:!1});return s||((s=factory.createContainer({scopeId:e,type:HttpClientMessageBus,variableName:"httpClientMessageBus",singleton:!1})).config({timeout:t}),s.config(createHttpClientStoppedMessageQueueBinding({scopeId:e})),s.config(createHttpClientStopMessageQueueBinding({scopeId:e})),s.config(createHttpClientStartedMessageQueueBinding({scopeId:e})),s.config(createHttpClientStartMessageQueueBinding({scopeId:e})),s.config(createHttpClientResponseMessageQueueBinding({scopeId:e})),s.config(createHttpClientRequestMessageQueueBinding({scopeId:e}))),s.ensureInstance(),s.references}function createHttpClientMessageBusManager({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpClientMessageBusManager,variableName:"httpClientMessageBusManager",singleton:!1});return t||((t=factory.createContainer({scopeId:e,type:HttpClientMessageBusManager,variableName:"httpClientMessageBusManager",singleton:!1})).config({}),t.config(createHttpClientStopMessageQueueBinding({scopeId:e})),t.config(createHttpClientStartedMessageQueueBinding({scopeId:e})),t.config(createHttpClientStartMessageQueueBinding({scopeId:e})),t.config(createHttpClientResponseMessageQueueBinding({scopeId:e})),t.config(createHttpClientRequestMessageQueueBinding({scopeId:e})),t.config(createHttpClientStoppedMessageQueueBinding({scopeId:e}))),t.ensureInstance(),t.references}function createHttpClientRequestMessageBus({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpClientRequestMessageBus,variableName:"httpClientRequestMessageBus",singleton:!1});return t||((t=factory.createContainer({scopeId:e,type:HttpClientRequestMessageBus,variableName:"httpClientRequestMessageBus",singleton:!1})).config({}),t.config(createHttpClientRequestMessageQueueBinding({scopeId:e}))),t.ensureInstance(),t.references}function createHttpClientRequestMessageQueueBinding({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpClientRequestMessageQueueBinding,variableName:"httpClientRequestMessageQueueBinding",singleton:!1});return t||((t=factory.createContainer({scopeId:e,type:HttpClientRequestMessageQueueBinding,variableName:"httpClientRequestMessageQueueBinding",singleton:!1})).config({}),t.config(createMessageQueue({scopeId:e}))),t.ensureInstance(),t.references}function createHttpClientResponseMessageBus({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpClientResponseMessageBus,variableName:"httpClientResponseMessageBus",singleton:!1});return t||((t=factory.createContainer({scopeId:e,type:HttpClientResponseMessageBus,variableName:"httpClientResponseMessageBus",singleton:!1})).config({}),t.config(createHttpClientResponseMessageQueueBinding({scopeId:e}))),t.ensureInstance(),t.references}function createHttpClientResponseMessageQueueBinding({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpClientResponseMessageQueueBinding,variableName:"httpClientResponseMessageQueueBinding",singleton:!1});return t||((t=factory.createContainer({scopeId:e,type:HttpClientResponseMessageQueueBinding,variableName:"httpClientResponseMessageQueueBinding",singleton:!1})).config({}),t.config(createMessageQueue({scopeId:e}))),t.ensureInstance(),t.references}function createHttpClientStartedMessageQueueBinding({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpClientStartedMessageQueueBinding,variableName:"httpClientStartedMessageQueueBinding",singleton:!0});return t||((t=factory.createContainer({scopeId:e,type:HttpClientStartedMessageQueueBinding,variableName:"httpClientStartedMessageQueueBinding",singleton:!0})).config({}),t.config(createMessageQueue({scopeId:e}))),t.ensureInstance(),t.references}function createHttpClientStartMessageQueueBinding({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpClientStartMessageQueueBinding,variableName:"httpClientStartMessageQueueBinding",singleton:!0});return t||((t=factory.createContainer({scopeId:e,type:HttpClientStartMessageQueueBinding,variableName:"httpClientStartMessageQueueBinding",singleton:!0})).config({}),t.config(createMessageQueue({scopeId:e}))),t.ensureInstance(),t.references}function createHttpClientStopMessageQueueBinding({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpClientStopMessageQueueBinding,variableName:"httpClientStopMessageQueueBinding",singleton:!0});return t||((t=factory.createContainer({scopeId:e,type:HttpClientStopMessageQueueBinding,variableName:"httpClientStopMessageQueueBinding",singleton:!0})).config({}),t.config(createMessageQueue({scopeId:e}))),t.ensureInstance(),t.references}function createHttpClientStoppedMessageQueueBinding({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpClientStoppedMessageQueueBinding,variableName:"httpClientStoppedMessageQueueBinding",singleton:!0});return t||((t=factory.createContainer({scopeId:e,type:HttpClientStoppedMessageQueueBinding,variableName:"httpClientStoppedMessageQueueBinding",singleton:!0})).config({}),t.config(createMessageQueue({scopeId:e}))),t.ensureInstance(),t.references}function createHttpRequestMessage({scopeId:e,messageStatusCode:t,Id:s,data:n,recipientHost:a,recipientPort:r,metadata:o,token:i,senderHost:c,senderPort:g}){let u=factory.getContainer({scopeId:e,type:HttpRequestMessage,variableName:"httpRequestMessage",singleton:!1});return u||((u=factory.createContainer({scopeId:e,type:HttpRequestMessage,variableName:"httpRequestMessage",singleton:!1})).config({messageStatusCode:t,Id:s,data:n,recipientHost:a,recipientPort:r,metadata:o,token:i,senderHost:c,senderPort:g}),u.config(createMessage({scopeId:e,messageStatusCode:t,Id:s,data:n,recipientHost:a,recipientPort:r,metadata:o,token:i,senderHost:c,senderPort:g}))),u.ensureInstance(),u.references}function createHttpResponseMessage({scopeId:e,messageStatusCode:t,Id:s,data:n,recipientHost:a,recipientPort:r,metadata:o,token:i,senderHost:c,senderPort:g}){let u=factory.getContainer({scopeId:e,type:HttpResponseMessage,variableName:"httpResponseMessage",singleton:!1});return u||((u=factory.createContainer({scopeId:e,type:HttpResponseMessage,variableName:"httpResponseMessage",singleton:!1})).config({messageStatusCode:t,Id:s,data:n,recipientHost:a,recipientPort:r,metadata:o,token:i,senderHost:c,senderPort:g}),u.config(createMessage({scopeId:e,messageStatusCode:t,Id:s,data:n,recipientHost:a,recipientPort:r,metadata:o,token:i,senderHost:c,senderPort:g}))),u.ensureInstance(),u.references}function createHttpServerMessageBus({scopeId:e,timeout:t,senderHost:s,senderPort:n}){let a=factory.getContainer({scopeId:e,type:HttpServerMessageBus,variableName:"httpServerMessageBus",singleton:!1});return a||((a=factory.createContainer({scopeId:e,type:HttpServerMessageBus,variableName:"httpServerMessageBus",singleton:!1})).config({timeout:t,senderHost:s,senderPort:n}),a.config(createLogger({scopeId:e})),a.config(createSenderAddress({scopeId:e,senderHost:s,senderPort:n})),a.config(createHttpServerStoppedMessageQueueBinding({scopeId:e})),a.config(createHttpServerStopMessageQueueBinding({scopeId:e})),a.config(createHttpServerStartedMessageQueueBinding({scopeId:e})),a.config(createHttpServerStartMessageQueueBinding({scopeId:e})),a.config(createHttpServerResponseMessageQueueBinding({scopeId:e})),a.config(createHttpServerRequestMessageQueueBinding({scopeId:e}))),a.ensureInstance(),a.references}function createHttpServerMessageBusManager({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpServerMessageBusManager,variableName:"httpServerMessageBusManager",singleton:!1});return t||((t=factory.createContainer({scopeId:e,type:HttpServerMessageBusManager,variableName:"httpServerMessageBusManager",singleton:!1})).config({}),t.config(createHttpServerStopMessageQueueBinding({scopeId:e})),t.config(createHttpServerStartedMessageQueueBinding({scopeId:e})),t.config(createHttpServerStartMessageQueueBinding({scopeId:e})),t.config(createHttpServerResponseMessageQueueBinding({scopeId:e})),t.config(createHttpServerRequestMessageQueueBinding({scopeId:e})),t.config(createHttpServerStoppedMessageQueueBinding({scopeId:e}))),t.ensureInstance(),t.references}function createHttpServerRequestMessageBus({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpServerRequestMessageBus,variableName:"httpServerRequestMessageBus",singleton:!1});return t||((t=factory.createContainer({scopeId:e,type:HttpServerRequestMessageBus,variableName:"httpServerRequestMessageBus",singleton:!1})).config({}),t.config(createHttpServerRequestMessageQueueBinding({scopeId:e}))),t.ensureInstance(),t.references}function createHttpServerRequestMessageQueueBinding({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpServerRequestMessageQueueBinding,variableName:"httpServerRequestMessageQueueBinding",singleton:!1});return t||((t=factory.createContainer({scopeId:e,type:HttpServerRequestMessageQueueBinding,variableName:"httpServerRequestMessageQueueBinding",singleton:!1})).config({}),t.config(createMessageQueue({scopeId:e}))),t.ensureInstance(),t.references}function createHttpServerResponseMessageBus({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpServerResponseMessageBus,variableName:"httpServerResponseMessageBus",singleton:!1});return t||((t=factory.createContainer({scopeId:e,type:HttpServerResponseMessageBus,variableName:"httpServerResponseMessageBus",singleton:!1})).config({}),t.config(createHttpServerResponseMessageQueueBinding({scopeId:e}))),t.ensureInstance(),t.references}function createHttpServerResponseMessageQueueBinding({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpServerResponseMessageQueueBinding,variableName:"httpServerResponseMessageQueueBinding",singleton:!1});return t||((t=factory.createContainer({scopeId:e,type:HttpServerResponseMessageQueueBinding,variableName:"httpServerResponseMessageQueueBinding",singleton:!1})).config({}),t.config(createMessageQueue({scopeId:e}))),t.ensureInstance(),t.references}function createHttpServerStartedMessageQueueBinding({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpServerStartedMessageQueueBinding,variableName:"httpServerStartedMessageQueueBinding",singleton:!0});return t||((t=factory.createContainer({scopeId:e,type:HttpServerStartedMessageQueueBinding,variableName:"httpServerStartedMessageQueueBinding",singleton:!0})).config({}),t.config(createMessageQueue({scopeId:e}))),t.ensureInstance(),t.references}function createHttpServerStartMessageQueueBinding({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpServerStartMessageQueueBinding,variableName:"httpServerStartMessageQueueBinding",singleton:!0});return t||((t=factory.createContainer({scopeId:e,type:HttpServerStartMessageQueueBinding,variableName:"httpServerStartMessageQueueBinding",singleton:!0})).config({}),t.config(createMessageQueue({scopeId:e}))),t.ensureInstance(),t.references}function createHttpServerStopMessageQueueBinding({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpServerStopMessageQueueBinding,variableName:"httpServerStopMessageQueueBinding",singleton:!0});return t||((t=factory.createContainer({scopeId:e,type:HttpServerStopMessageQueueBinding,variableName:"httpServerStopMessageQueueBinding",singleton:!0})).config({}),t.config(createMessageQueue({scopeId:e}))),t.ensureInstance(),t.references}function createHttpServerStoppedMessageQueueBinding({scopeId:e}){let t=factory.getContainer({scopeId:e,type:HttpServerStoppedMessageQueueBinding,variableName:"httpServerStoppedMessageQueueBinding",singleton:!0});return t||((t=factory.createContainer({scopeId:e,type:HttpServerStoppedMessageQueueBinding,variableName:"httpServerStoppedMessageQueueBinding",singleton:!0})).config({}),t.config(createMessageQueue({scopeId:e}))),t.ensureInstance(),t.references}function createWebSocketClientRequestMessageBus({scopeId:e}){let t=factory.getContainer({scopeId:e,type:WebSocketClientRequestMessageBus,variableName:"webSocketClientRequestMessagebus",singleton:!1});return t||((t=factory.createContainer({scopeId:e,type:WebSocketClientRequestMessageBus,variableName:"webSocketClientRequestMessagebus",singleton:!1})).config({}),t.config(createWebSocketClientRequestMessageQueueBinding({scopeId:e}))),t.ensureInstance(),t.references}function createWebSocketClientRequestMessageQueueBinding({scopeId:e}){let t=factory.getContainer({scopeId:e,type:WebSocketClientRequestMessageQueueBinding,variableName:"websocketClientRequestMessageQueueBinding",singleton:!1});return t||((t=factory.createContainer({scopeId:e,type:WebSocketClientRequestMessageQueueBinding,variableName:"websocketClientRequestMessageQueueBinding",singleton:!1})).config({}),t.config(createMessageQueue({scopeId:e}))),t.ensureInstance(),t.references}function createWebSocketClientResponseMessageBus({scopeId:e}){let t=factory.getContainer({scopeId:e,type:WebSocketClientResponseMessageBus,variableName:"webSocketClientResponseMessageBus",singleton:!1});return t||((t=factory.createContainer({scopeId:e,type:WebSocketClientResponseMessageBus,variableName:"webSocketClientResponseMessageBus",singleton:!1})).config({}),t.config(createWebSocketClientResponseMessageQueueBinding({scopeId:e}))),t.ensureInstance(),t.references}function createWebSocketClientResponseMessageQueueBinding({scopeId:e}){let t=factory.getContainer({scopeId:e,type:WebSocketClientResponseMessageQueueBinding,variableName:"websocketClientResponseMessageQueueBinding",singleton:!1});return t||((t=factory.createContainer({scopeId:e,type:WebSocketClientResponseMessageQueueBinding,variableName:"websocketClientResponseMessageQueueBinding",singleton:!1})).config({}),t.config(createMessageQueue({scopeId:e}))),t.ensureInstance(),t.references}Factory.prototype.createContainer=function(e){},ClientMessageBus.prototype.publish=async function({}){},ClientMessageBus.prototype.subscribe=function({}){},Component.prototype.initialise=async function({}){},Component.prototype.receive=async function({}){throw new Error("component was not initialised.")},Component.prototype.send=async function({}){throw new Error("component was not initialised.")},ContentType.prototype.name="",ContentType.prototype.description="",Logger.prototype.log=function({}){},Message.prototype.getId=function(){},Message.prototype.getSenderAddress=function(){},Message.prototype.getRecipientAddress=function(){},Message.prototype.getEncryptedContent=function(){},Message.prototype.getDecryptedContent=function(){},Message.prototype.getMessageMetadata=function(){},Message.prototype.getContentMetadata=function(){},Message.prototype.getMessageStatus=function(){},MessageContent.prototype.encryptedData=function(){},MessageContent.prototype.decryptedData=function(){},MessageContentMetadata.prototype.contentType="",MessageContentMetadata.prototype.contentLength=-1,MessageContentMetadata.prototype.isEncrypted="",MessageConverter.prototype.convertMessageToHttpRequestMessage=function({}){},MessageConverter.prototype.convertMessageToHttpResponseMessage=function({}){},MessageConverter.prototype.convertHttpRequestMessageToMessage=function({}){},MessageConverter.prototype.convertHttpResponseMessageToMessage=function({}){},MessageMetadata.prototype.create=function({}){},MessageQueue.prototype.queueMessage=function({}){},MessageQueue.prototype.dequeueMessage=function({}){},MessageQueue.prototype.peekMessage=function({}){},MessageQueue.prototype.bind=function({}){},MessageQueue.prototype.unbind=function({}){},MessageStatus.prototype.match=function({}){},MessageStatus.prototype.root=function(){},MessageStore.prototype.save=async function({}){},MessageStore.prototype.get=async function({}){},ServerMessageBus.prototype.publish=async function({}){},ServerMessageBus.prototype.subscribe=function({}){},UserSecurity.prototype.isRegistered=function(){},UserSecurity.prototype.authenticate=function({}){},UserSecurity.prototype.isAuthorised=function({}){},UserSecurity.prototype.register=function({}){},UserSecurity.prototype.unregister=function(){},UserSecurity.prototype.getHashedPassphrase=function(){},UserSecurity.prototype.getUserId=function(){},UserSecurity.prototype.getBase64KeyPair=function(){},UserSecurity.prototype.getKeyPair=function(){},UserSecurity.prototype.getToken=function(){},UserSecurity.prototype.encryptObjectToJSON=function({}){},UserSecurity.prototype.decryptJSONToObject=function({}){},UserSessions.prototype.ensureSession=function({}){},HttpClientRequestMessageBus.prototype.publish=function({}){},HttpClientResponseMessageBus.prototype.subscribe=function({}){},HttpRequestMessage.prototype.getId=function(){},HttpRequestMessage.prototype.getEncryptedContent=function(){},HttpRequestMessage.prototype.getDecryptedContent=function(){},HttpRequestMessage.prototype.getSenderAddress=function(){},HttpRequestMessage.prototype.getRecipientAddress=function(){},HttpRequestMessage.prototype.getContentMetadata=function(){},HttpRequestMessage.prototype.getMessageMetadata=function(){},HttpRequestMessage.prototype.getHeaders=function(){},HttpRequestMessage.prototype.getPath=function(){},HttpRequestMessage.prototype.getMessageStatus=function(){},HttpRequestMessage.prototype.getMethod=function(){},HttpResponseMessage.prototype.getId=function(){},HttpResponseMessage.prototype.getEncryptedContent=function(){},HttpResponseMessage.prototype.getDecryptedContent=function(){},HttpResponseMessage.prototype.getSenderAddress=function(){},HttpResponseMessage.prototype.getRecipientAddress=function(){},HttpResponseMessage.prototype.getContentMetadata=function(){},HttpResponseMessage.prototype.getMessageMetadata=function(){},HttpResponseMessage.prototype.getHeaders=function(){},HttpResponseMessage.prototype.getMessageStatus=function(){},HttpResponseMessage.prototype.getStatusCode=function(){},HttpResponseMessage.prototype.getStatusMessage=function(){},HttpServerRequestMessageBus.prototype.subscribe=function({}){},HttpServerResponseMessageBus.prototype.publish=async function({}){},WebSocketClientRequestMessageBus.prototype.publish=function({}){},WebSocketClientResponseMessageBus.prototype.subscribe=function({}){};